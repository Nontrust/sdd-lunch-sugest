# smart-recommend Specification

## Purpose
최근 추천 이력 기반으로 중복을 방지하는 스마트 추천 기능을 제공한다. 모든 후보가 제외된 경우 폴백 추천을 수행한다.

## Requirements
### Requirement: 스마트 추천 필터링
시스템은 스마트 추천 모드에서 최근 N일(기본 3일) 내 추천된 식당을 후보에서 제외하고 추천해야 한다(SHALL). 제외 기준은 restaurantId 기반이며, 메뉴 단위 중복 방지는 수행하지 않는다(SHALL).

#### Scenario: 최근 추천 식당 제외
- **WHEN** 스마트 추천 모드에서 추천 요청이 들어오고 최근 3일 내 "스시이담"이 추천된 적이 있으면
- **THEN** "스시이담"을 후보에서 제외하고 나머지 식당 중에서 랜덤 추천한다

#### Scenario: 여러 식당이 최근 추천된 경우
- **WHEN** 최근 3일 내 "스시이담"과 "김밥천국"이 추천된 적이 있으면
- **THEN** 두 식당 모두 후보에서 제외하고 나머지 식당 중에서 랜덤 추천한다

### Requirement: 폴백 추천
시스템은 스마트 추천에서 모든 후보 식당이 최근 추천 이력에 의해 제외된 경우, 폴백으로 전체 후보에서 랜덤 추천을 수행해야 한다(SHALL). 폴백 발생 시 사용자에게 안내 메시지를 표시해야 한다(SHALL).

#### Scenario: 모든 식당이 최근 추천된 경우 폴백
- **WHEN** 선택된 카테고리의 모든 식당이 최근 3일 내 추천된 적이 있으면
- **THEN** 필터링을 해제하고 전체 후보에서 랜덤 추천하며 "최근 방문한 식당이지만 추천합니다" 안내를 표시한다

#### Scenario: 카테고리 필터링 후 후보가 없는 경우
- **WHEN** 특정 카테고리 선택 후 해당 카테고리의 모든 식당이 최근 추천 이력에 의해 제외되면
- **THEN** 해당 카테고리 내 전체 식당에서 폴백 랜덤 추천을 수행한다

### Requirement: 중복 방지 기간 설정
시스템은 중복 방지 기간을 상수로 관리해야 한다(SHALL). 기본값은 3일이며, 코드 내 상수 변경으로 조정 가능해야 한다(SHALL).

#### Scenario: 기본 중복 방지 기간
- **WHEN** 스마트 추천이 히스토리를 조회할 때
- **THEN** 기본적으로 최근 3일간의 기록을 기준으로 중복 방지를 적용한다

#### Scenario: 중복 방지 기간 밖의 식당
- **WHEN** 4일 전에 추천된 식당이 있고 중복 방지 기간이 3일이면
- **THEN** 해당 식당은 제외 대상이 아니므로 정상적으로 후보에 포함된다
